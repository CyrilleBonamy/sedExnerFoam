<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Laminar flow tutorials | sedExnerFoam</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600&amp;subset=latin-ext" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="sedExnerFoam_favicon.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m"><img src="sedExnerFoam_favicon.png" alt="" />sedExnerFoam</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li>
              <a href="pages.html">Pages</a>
              <ol>
                <li><a href="index.html">About sedExnerFoam</a></li>
                <li><a href="install.html">Installation</a></li>
                <li><a href="howtodocker.html">How To work with sedFoam container</a></li>
                <li><a href="howtogit.html">How To work with github</a></li>
                <li><a href="faq.html">Frequently Asked Questions</a></li>
              </ol>
            </li>
            <li>
              <a href="pages.html">Tutorials</a>
              <ol>
                <li><a href="tutorials_laminar.html" id="m-navbar-current">Laminar flow tutorials</a></li>
              </ol>
            </li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li>
              <a href="governingEq.html">Governing equations</a>
              <ol>
                <li><a href="governingEq.html">Governing equations</a></li>
              </ol>
            </li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Laminar flow tutorials
        </h1>
        <nav class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              <a href="#Sedim_testcase">1DSedim: Pure sedimentation</a>
              <ul>
                <li>
                  <a href="#preproc">Pre-processing</a>
                  <ul>
                    <li><a href="#meshgen">Mesh generation</a></li>
                    <li><a href="#BC_init">Boundary and initial conditions</a></li>
                    <li><a href="#PhysProp">Physical properties</a></li>
                    <li><a href="#control_sedFoam">Control</a></li>
                    <li><a href="#Disc_solv">Discretisation and linear-solver settings</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
<p>In this chapter we shall describe in detail the process of setup, simulation and post-processing for SedFoam test cases in the laminar flow regime. All the tutorial cases are in the <em>tutorials/laminar</em> directory. The text herein is highly inspired from the OpenFOAM user-guide for the cavity tutorial available at <a href="http://cfd.direct/openfoam/user-guide/cavity/">http:/<wbr />/<wbr />cfd.direct/<wbr />openfoam/<wbr />user-guide/<wbr />cavity/<wbr /></a> but is adapted to the specificity of SedFoam.</p><p>The test cases provided with SedFoam are aimed to facilitate the learning as well as the development of new configurations. If you develop new feature do not hesitate to share your development with us so that we can incorporate them in the github repository and others will benefit from your work the way you benefited from the original SedFoam version!</p><p>A number of one-dimensional test cases are provided with reference solutions, analytical, experimental or numerical, to validate SedFoam implementation and developments. Most of these test cases are used in the contiunous integration procedure to verify new developments in SedFoam.</p><section id="Sedim_testcase"><h2><a href="#Sedim_testcase">1DSedim: Pure sedimentation</a></h2><p>This tutorial will describe how to pre-process, run and post-process a case corresponding to a pure sedimentation problem in a one-dimensional configuration using the two-phase flow equations. The geometry is shown in Figure 1 in which bottom boundary is a wall and the top boundary is an open boundary. Initially, the flow is at rest and will be solved on a uniform mesh using the SedFoam solver for laminar, isothermal, incompressible two-phase flow. The numerical results are compared with experiments to validate the model in terms of settling curves, time evolution of concentration interface, and concentration profiles.</p><section id="preproc"><h3><a href="#preproc">Pre-processing</a></h3><p>Like in OpenFOAM, cases are setup by editing case files using a text editor such as atome, vscode/vscodium, emacs, vi, gedit, nedit, etc. The I/O uses a dictionary format with keywords. A case involves data for mesh, fields, properties, control parameters, etc that are stored in a set of files within a case directory rather than in a single case file. The case directory is given a suitably descriptive name. This tutorial consists of a set of cases located in the SedFoam distribution under the folder <em>sedFoamDirectory/turheolotorials/laminar/1DSedim</em>.</p><section id="meshgen"><h5><a href="#meshgen">Mesh generation</a></h5><p>OpenFOAM always operates in a 3 dimensional Cartesian coordinate system and all geometries are generated in 3 dimensions. OpenFOAM solves the case in 3 dimensions by default but can be instructed to solve in 2 dimensions by specifying a ‘special’ empty boundary condition on boundaries normal to the (3rd) dimension for which no solution is required. In 2 dimensions, the directions x and y are always chosen even if the mesh is given in the x-z plane.</p><p>The sedimentation domain consists of a rectangle of side length L = 0.006 m in the x–y plane and of height h=0.06 m in the vertical direction z. The side length is chosen to ensure a unity cell aspect ratio. A uniform mesh of 1 by 1 by 100 cells will be used. The block structure is shown in Figure 1.</p><p>The mesh generator supplied with OpenFOAM, blockMesh, generates meshes from a description specified in an input dictionary, blockMeshDict located in the <em>constant/polyMesh</em> directory for a given case. The <em>blockMeshDict</em> entries for this case are as follows:</p><pre>/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  1.7.1                                 |
|   \\  /    A nd           | Web:      www.OpenFOAM.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      blockMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

scale 0.06;

vertices
(
    (-0.005 0   0.005) //0
    ( 0.005 0   0.005) //1
    ( 0.005 1.  0.005) //2
    (-0.005 1.  0.005) //3
    (-0.005 0  -0.005) //4
    ( 0.005 0  -0.005) //5
    ( 0.005 1. -0.005) //6
    (-0.005 1. -0.005) //7
);

blocks
(
    hex (0 1 5 4 3 2 6 7) (1 1 200) simpleGrading (1 1 1)
);

edges
(
);

boundary
(
    inlet
    {
     type   cyclic;
     neighbourPatch outlet;
     faces ((0 3 7 4));
    }
    outlet
    {
     type   cyclic;
     neighbourPatch  inlet;
     faces  ((1 5 6 2));
    }
    top
    {
     type wall;
        faces ((7 6 2 3));
    }
    bottom
    {
     type wall;
     faces ((0 4 5 1));
    }
    frontAndBackPlanes
    {
    type empty;
    faces (
           (0 1 2 3)
           (4 7 6 5)
          );
    }
);

mergePatchPairs
(
);

// ************************************************************************* //</pre><p>The file first contains header information in the form of a banner (lines 1-7), then file information contained in a FoamFile sub-dictionary, delimited by curly braces ({…}).</p><p>The file specifies coordinates of the block vertices; then, it defines the blocks (here, only 1) from the vertex labels and the number of cells within it; and finally, it defines the boundary patches. The user is encouraged to consult the official documentation <a href="http://cfd.direct/openfoam/user-guide/blockMesh/#x25-1750005.3">here</a> to understand the meaning of the entries in the <em>blockMeshDict</em> file.</p><p>The mesh is generated by running the command blockMesh. This is done simply by typing in the terminal:</p><pre>blockMesh
</pre><p>The running status of blockMesh is reported in the terminal window. Any mistakes in the <em>blockMeshDict</em> file are picked up by blockMesh and the resulting error message directs the user to the line in the file where the problem occurred. There should be no error messages at this stage.</p></section><section id="BC_init"><h5><a href="#BC_init">Boundary and initial conditions</a></h5><p>Once the mesh generation is complete, the user can look at this initial fields set up for this case. The case is set up to start at time t = 0 s, so the initial field data is stored in a 0_org sub-directory of the 1DSedim directory. The 0_org sub-directory contains several files: alpha.a, U.a, U.b, p_rbgh, muI, pa, Theta, one for each of the solid phase volume fraction (alpha.a), velocities of solid and fluid phases (U.a and U.b), the reduced pressure (p_rbgh) fields whose initial values and boundary conditions must be set. Let us examine file U.a:</p><pre>dimensions      [0 1 -1 0 0 0 0];

internalField   uniform (0 0 0);

boundaryField
{
    inlet
    {
        type            cyclic;
    }
    outlet
    {
        type            cyclic;
    }
    top
    {
        type            zeroGradient;
    }
    bottom
    {
        type            fixedValue;
        value           uniform (0 0 0);
    }
    frontAndBackPlanes
    {
        type            empty;
    }
}</pre><p>There are 3 principal entries in field data files:</p><p>-dimensions: specifies the dimensions of the field, here velocity, i.e. m s <svg class="m-math" style="width: 1.127em; height: 0.622em; vertical-align: -0.000em;" viewBox="0 -9.474739 10.82069 5.966563">
<title>
$^{-1}$
</title>
<defs>
<path id='eq1-g1-49' d='M2.502615-5.076961C2.502615-5.292154 2.486675-5.300125 2.271482-5.300125C1.944707-4.98132 1.522291-4.790037 .765131-4.790037V-4.527024C.980324-4.527024 1.41071-4.527024 1.872976-4.742217V-.653549C1.872976-.358655 1.849066-.263014 1.091905-.263014H.812951V0C1.139726-.02391 1.825156-.02391 2.183811-.02391S3.235866-.02391 3.56264 0V-.263014H3.283686C2.526526-.263014 2.502615-.358655 2.502615-.653549V-5.076961Z'/>
<path id='eq1-g0-0' d='M5.571108-1.809215C5.69863-1.809215 5.873973-1.809215 5.873973-1.992528S5.69863-2.175841 5.571108-2.175841H1.004234C.876712-2.175841 .70137-2.175841 .70137-1.992528S.876712-1.809215 1.004234-1.809215H5.571108Z'/>
</defs>
<g id='eq1-page1'>
<use x='0' y='-4.338437' xlink:href='#eq1-g0-0'/>
<use x='6.586507' y='-4.338437' xlink:href='#eq1-g1-49'/>
</g>
</svg> ;</p><p>-internalField: the internal field data which are set to be uniform;</p><p>-boundaryField: the boundary field data that includes boundary conditions and data for all the boundary patches.</p><p>For this case, boundary conditions consist of cyclic boundaries at the inlet and outlet (left and right boundaries) and walls at the top and bottom boundaries, the top boundary is zeroGradient whereas the bottom boundary is a no-slip boundary conditions i.e zero velocity at the wall. The frontAndBack patch represents the front and back planes of the 2D case and therefore must be set as empty.</p><p>The user can, similarly, examine the fluid phase velocity field in the 0_org/U.b file. The solid phase volume fraction has zeroGradient boundary conditions at the top and bottom boundaries whereas the pressure has fixedValue at the top boundary (equivalent to setting the atmospheric pressure) and a fixedFluxPressure at the bottom boundary. We shall explain below what this boundary condition means.</p></section><section id="PhysProp"><h5><a href="#PhysProp">Physical properties</a></h5><p>The physical properties for the case are stored in dictionaries whose names are given the suffix …Properties, located in the Dictionaries directory tree. For a SedFoam case, there are 8 property files: transportProperties, interfacialProperties, ppProperties, granularRheologyProperties, kineticTheoryProperties, RASProperties twophaseRASProperties</p><p>In the transport property file, the physical properties of the solid and fluid phases are set, such as density, kinematic viscosity and particle diameter.</p><pre>// * * * * * * * * * * * * sediment properties * * * * * * * * * * * * //
phasea
{
    rho             rho [ 1 -3 0 0 0 ] 1050;
    nu              nu [ 0 2 -1 0 0 ] 1e-6;
    d               d [ 0 1 0 0 0 0 0 ] 290e-6;
    hExp            hExp [ 0 0  0 0 0 0 0 ] 3.15;  // hindrance exponent for drag: beta^(-hExp) (2.65 by default)
}
// * * * * * * * * * * * * fluid properties * * * * * * * * * * * * //
phaseb
{
    rho             rho [ 1 -3 0 0 0 ] 950;
    nu              nu [ 0 2 -1 0 0 ] 2.105e-05;
    d               d [ 0 1 0 0 0 0 0 ] 290e-6;
}
//*********************************************************************** //
transportModel  Newtonian;

nu              nu [ 0 2 -1 0 0 0 0 ] 2.105e-05;

nuMax           nuMax [0 2 -1 0 0 0 0] 1e0;      // viscosity limiter for the Frictional model (required for stability)

alphaSmall      alphaSmall [ 0 0 0 0 0 0 0 ] 1e-6;  // minimum volume fraction (phase a) for division by alpha</pre><p>The hindrance function exponent of the Richardson-Zaki law can be tuned using the parameter hExp. This is important for this first test case which is in the laminar regime for the drag. The transportModel has to be prescribed when using turbulence model, it is present here for compatibility with the other test cases. The nuMax value is a viscosity limiter for the all the viscosities, it allows the user to control the numerical stability of the solver and will be discussed in the second test case. It is especially important as some shear stress terms are discretized explicitly and the frictional viscosity can reach huge values. The alphaSmall value is used to regularise the division by alpha.a in the source code, the default value is set to <svg class="m-math" style="width: 2.347em; height: 0.987em; vertical-align: -0.000em;" viewBox="0 -9.474739 22.52667 9.474739">
<title>
$ 10^{-6} $
</title>
<defs>
<path id='eq2-g1-54' d='M1.099875-2.638107C1.099875-3.299626 1.155666-3.881445 1.44259-4.367621C1.681694-4.766127 2.088169-5.092902 2.590286-5.092902C2.749689-5.092902 3.116314-5.068991 3.299626-4.790037C2.940971-4.774097 2.909091-4.503113 2.909091-4.415442C2.909091-4.176339 3.092403-4.040847 3.283686-4.040847C3.427148-4.040847 3.658281-4.128518 3.658281-4.431382C3.658281-4.909589 3.299626-5.300125 2.582316-5.300125C1.474471-5.300125 .350685-4.24807 .350685-2.526526C.350685-.366625 1.354919 .167372 2.12802 .167372C2.510585 .167372 2.925031 .063761 3.283686-.278954C3.602491-.589788 3.873474-.924533 3.873474-1.617933C3.873474-2.662017 3.084433-3.395268 2.199751-3.395268C1.625903-3.395268 1.283188-3.028643 1.099875-2.638107ZM2.12802-.071731C1.705604-.071731 1.44259-.366625 1.323039-.589788C1.139726-.948443 1.123786-1.490411 1.123786-1.793275C1.123786-2.582316 1.554172-3.172105 2.16787-3.172105C2.566376-3.172105 2.805479-2.964882 2.956912-2.685928C3.124284-2.391034 3.124284-2.032379 3.124284-1.625903S3.124284-.868742 2.964882-.581818C2.757659-.215193 2.478705-.071731 2.12802-.071731Z'/>
<path id='eq2-g0-0' d='M5.571108-1.809215C5.69863-1.809215 5.873973-1.809215 5.873973-1.992528S5.69863-2.175841 5.571108-2.175841H1.004234C.876712-2.175841 .70137-2.175841 .70137-1.992528S.876712-1.809215 1.004234-1.809215H5.571108Z'/>
<path id='eq2-g2-48' d='M5.355915-3.825654C5.355915-4.817933 5.296139-5.786301 4.865753-6.694894C4.375592-7.687173 3.514819-7.950187 2.929016-7.950187C2.235616-7.950187 1.3868-7.603487 .944458-6.611208C.609714-5.858032 .490162-5.116812 .490162-3.825654C.490162-2.666002 .573848-1.793275 1.004234-.944458C1.470486-.035866 2.295392 .251059 2.917061 .251059C3.957161 .251059 4.554919-.37061 4.901619-1.06401C5.332005-1.960648 5.355915-3.132254 5.355915-3.825654ZM2.917061 .011955C2.534496 .011955 1.75741-.203238 1.530262-1.506351C1.398755-2.223661 1.398755-3.132254 1.398755-3.969116C1.398755-4.94944 1.398755-5.834122 1.590037-6.539477C1.793275-7.340473 2.402989-7.711083 2.917061-7.711083C3.371357-7.711083 4.064757-7.436115 4.291905-6.40797C4.447323-5.726526 4.447323-4.782067 4.447323-3.969116C4.447323-3.16812 4.447323-2.259527 4.315816-1.530262C4.088667-.215193 3.335492 .011955 2.917061 .011955Z'/>
<path id='eq2-g2-49' d='M3.443088-7.663263C3.443088-7.938232 3.443088-7.950187 3.203985-7.950187C2.917061-7.627397 2.319303-7.185056 1.08792-7.185056V-6.838356C1.362889-6.838356 1.960648-6.838356 2.618182-7.149191V-.920548C2.618182-.490162 2.582316-.3467 1.530262-.3467H1.159651V0C1.482441-.02391 2.642092-.02391 3.036613-.02391S4.578829-.02391 4.901619 0V-.3467H4.531009C3.478954-.3467 3.443088-.490162 3.443088-.920548V-7.663263Z'/>
</defs>
<g id='eq2-page1'>
<use x='0' y='0' xlink:href='#eq2-g2-49'/>
<use x='5.85299' y='0' xlink:href='#eq2-g2-48'/>
<use x='11.705981' y='-4.338437' xlink:href='#eq2-g0-0'/>
<use x='18.292487' y='-4.338437' xlink:href='#eq2-g1-54'/>
</g>
</svg>.</p><p>The dictionary <em>interfacialProperties</em> allows to specify the drag model:</p><pre>dragModela      GidaspowSchillerNaumann;

dragModelb      GidaspowSchillerNaumann;

dragPhase       a;
</pre><p>The model chosen here is GidaspowSchilerNaumann that corresponds to the drag force around a spherical particle corrected by a hindrance function ( <svg class="m-math" style="width: 3.585em; height: 1.271em; vertical-align: -0.243em;" viewBox="0 -9.873238 34.420271 12.197846">
<title>
$ \beta^{-hExp}$
</title>
<defs>
<path id='eq3-g1-69' d='M5.969614-1.849066C5.985554-1.880946 6.001494-1.928767 6.001494-1.960648C6.001494-1.976588 5.993524-2.072229 5.881943-2.072229C5.794271-2.072229 5.786301-2.048319 5.7066-1.872976C5.196513-.70934 4.821918-.263014 3.52279-.263014H2.072229C2.000498-.278954 1.976588-.278954 1.976588-.334745C1.976588-.398506 1.992528-.462267 2.008468-.510087L2.558406-2.685928H3.411208C3.993026-2.685928 4.112578-2.590286 4.112578-2.335243C4.112578-2.327273 4.112578-2.199751 4.056787-1.976588C4.040847-1.936737 4.032877-1.888917 4.032877-1.865006C4.032877-1.857036 4.040847-1.753425 4.152428-1.753425C4.24807-1.753425 4.26401-1.801245 4.29589-1.936737L4.718306-3.602491C4.726276-3.626401 4.750187-3.745953 4.750187-3.761893C4.750187-3.841594 4.686426-3.881445 4.630635-3.881445C4.527024-3.881445 4.519054-3.825654 4.479203-3.690162C4.319801-3.068493 4.104608-2.948941 3.419178-2.948941H2.622167L3.100374-4.853798C3.172105-5.140722 3.180075-5.156663 3.506849-5.156663H4.750187C5.7066-5.156663 6.009465-4.96538 6.009465-4.26401C6.009465-4.096638 5.969614-3.897385 5.969614-3.745953C5.969614-3.650311 6.025405-3.610461 6.089166-3.610461C6.200747-3.610461 6.208717-3.682192 6.224658-3.817684L6.36812-5.172603C6.37609-5.212453 6.37609-5.268244 6.37609-5.308095C6.37609-5.419676 6.280448-5.419676 6.136986-5.419676H1.936737C1.785305-5.419676 1.689664-5.419676 1.689664-5.268244C1.689664-5.156663 1.793275-5.156663 1.928767-5.156663C1.952677-5.156663 2.096139-5.156663 2.231631-5.140722C2.399004-5.124782 2.414944-5.100872 2.414944-5.029141C2.414944-4.98929 2.399004-4.941469 2.391034-4.901619L1.323039-.629639C1.251308-.326775 1.235367-.263014 .645579-.263014C.494147-.263014 .398506-.263014 .398506-.111582C.398506 0 .502117 0 .637609 0H4.94944C5.148692 0 5.156663 0 5.220423-.143462L5.969614-1.849066Z'/>
<path id='eq3-g1-104' d='M2.327273-5.292154C2.335243-5.308095 2.359153-5.411706 2.359153-5.419676C2.359153-5.459527 2.327273-5.531258 2.231631-5.531258C2.199751-5.531258 1.952677-5.507347 1.769365-5.491407L1.323039-5.459527C1.147696-5.443587 1.067995-5.435616 1.067995-5.292154C1.067995-5.180573 1.179577-5.180573 1.275218-5.180573C1.657783-5.180573 1.657783-5.132752 1.657783-5.061021C1.657783-5.037111 1.657783-5.021171 1.617933-4.877709L.486177-.342715C.454296-.223163 .454296-.175342 .454296-.167372C.454296-.03188 .565878 .079701 .71731 .079701C.844832 .079701 .956413 0 1.020174-.103611C1.044085-.151432 1.107846-.406476 1.147696-.565878L1.331009-1.275218C1.354919-1.39477 1.43462-1.697634 1.458531-1.817186C1.578082-2.279452 1.578082-2.295392 1.753425-2.550436C2.024408-2.940971 2.399004-3.291656 2.933001-3.291656C3.219925-3.291656 3.387298-3.124284 3.387298-2.749689C3.387298-2.311333 3.052553-1.40274 2.901121-1.012204C2.797509-.749191 2.797509-.70137 2.797509-.597758C2.797509-.143462 3.172105 .079701 3.514819 .079701C4.29589 .079701 4.622665-1.036115 4.622665-1.139726C4.622665-1.219427 4.558904-1.243337 4.503113-1.243337C4.407472-1.243337 4.391532-1.187547 4.367621-1.107846C4.176339-.454296 3.841594-.143462 3.53873-.143462C3.411208-.143462 3.347447-.223163 3.347447-.406476S3.411208-.765131 3.490909-.964384C3.610461-1.267248 3.961146-2.183811 3.961146-2.630137C3.961146-3.227895 3.5467-3.514819 2.972852-3.514819C2.526526-3.514819 2.10411-3.323537 1.737484-2.901121L2.327273-5.292154Z'/>
<path id='eq3-g1-112' d='M.414446 .964384C.350685 1.219427 .334745 1.283188 .01594 1.283188C-.095641 1.283188-.191283 1.283188-.191283 1.43462C-.191283 1.506351-.119552 1.546202-.079701 1.546202C0 1.546202 .03188 1.522291 .621669 1.522291C1.195517 1.522291 1.362889 1.546202 1.41868 1.546202C1.45056 1.546202 1.570112 1.546202 1.570112 1.39477C1.570112 1.283188 1.458531 1.283188 1.362889 1.283188C.980324 1.283188 .980324 1.235367 .980324 1.163636C.980324 1.107846 1.123786 .541968 1.362889-.390535C1.466501-.207223 1.713574 .079701 2.14396 .079701C3.124284 .079701 4.144458-1.052055 4.144458-2.207721C4.144458-2.996762 3.634371-3.514819 2.996762-3.514819C2.518555-3.514819 2.13599-3.188045 1.904857-2.948941C1.737484-3.514819 1.203487-3.514819 1.123786-3.514819C.836862-3.514819 .637609-3.331507 .510087-3.084433C.326775-2.725778 .239103-2.319303 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.223661 .526027-2.430884C.629639-2.83736 .773101-3.291656 1.099875-3.291656C1.299128-3.291656 1.354919-3.108344 1.354919-2.917061C1.354919-2.83736 1.323039-2.646077 1.307098-2.582316L.414446 .964384ZM1.880946-2.454795C1.920797-2.590286 1.920797-2.606227 2.040349-2.749689C2.343213-3.108344 2.685928-3.291656 2.972852-3.291656C3.371357-3.291656 3.52279-2.901121 3.52279-2.542466C3.52279-2.247572 3.347447-1.39477 3.108344-.924533C2.901121-.494147 2.518555-.143462 2.14396-.143462C1.601993-.143462 1.474471-.765131 1.474471-.820922C1.474471-.836862 1.490411-.924533 1.498381-.948443L1.880946-2.454795Z'/>
<path id='eq3-g1-120' d='M3.993026-3.180075C3.642341-3.092403 3.626401-2.781569 3.626401-2.749689C3.626401-2.574346 3.761893-2.454795 3.937235-2.454795S4.383562-2.590286 4.383562-2.933001C4.383562-3.387298 3.881445-3.514819 3.58655-3.514819C3.211955-3.514819 2.909091-3.251806 2.725778-2.940971C2.550436-3.363387 2.13599-3.514819 1.809215-3.514819C.940473-3.514819 .454296-2.518555 .454296-2.295392C.454296-2.223661 .510087-2.191781 .573848-2.191781C.669489-2.191781 .68543-2.231631 .70934-2.327273C.892653-2.909091 1.370859-3.291656 1.785305-3.291656C2.096139-3.291656 2.247572-3.068493 2.247572-2.781569C2.247572-2.622167 2.15193-2.255542 2.088169-2.000498C2.032379-1.769365 1.857036-1.060025 1.817186-.908593C1.705604-.478207 1.41868-.143462 1.060025-.143462C1.028144-.143462 .820922-.143462 .653549-.255044C1.020174-.342715 1.020174-.67746 1.020174-.68543C1.020174-.868742 .876712-.980324 .70137-.980324C.486177-.980324 .255044-.797011 .255044-.494147C.255044-.127522 .645579 .079701 1.052055 .079701C1.474471 .079701 1.769365-.239103 1.912827-.494147C2.088169-.103611 2.454795 .079701 2.83736 .079701C3.706102 .079701 4.184309-.916563 4.184309-1.139726C4.184309-1.219427 4.120548-1.243337 4.064757-1.243337C3.969116-1.243337 3.953176-1.187547 3.929265-1.107846C3.769863-.573848 3.315567-.143462 2.8533-.143462C2.590286-.143462 2.399004-.318804 2.399004-.653549C2.399004-.812951 2.446824-.996264 2.558406-1.44259C2.614197-1.681694 2.789539-2.383064 2.82939-2.534496C2.940971-2.948941 3.219925-3.291656 3.57858-3.291656C3.618431-3.291656 3.825654-3.291656 3.993026-3.180075Z'/>
<path id='eq3-g0-0' d='M5.571108-1.809215C5.69863-1.809215 5.873973-1.809215 5.873973-1.992528S5.69863-2.175841 5.571108-2.175841H1.004234C.876712-2.175841 .70137-2.175841 .70137-1.992528S.876712-1.809215 1.004234-1.809215H5.571108Z'/>
<path id='eq3-g2-12' d='M6.766625-6.957908C6.766625-7.675218 6.156912-8.428394 5.068991-8.428394C3.526775-8.428394 2.546451-6.539477 2.235616-5.296139L.3467 2.199751C.32279 2.295392 .394521 2.319303 .454296 2.319303C.537983 2.319303 .597758 2.307347 .609714 2.247572L1.446575-1.099875C1.566127-.430386 2.223661 .119552 2.929016 .119552C4.638605 .119552 6.252553-1.219427 6.252553-3.000747C6.252553-3.455044 6.144956-3.90934 5.893898-4.291905C5.750436-4.519054 5.571108-4.686426 5.379826-4.829888C6.240598-5.284184 6.766625-6.01345 6.766625-6.957908ZM4.686426-4.841843C4.495143-4.770112 4.303861-4.746202 4.076712-4.746202C3.90934-4.746202 3.753923-4.734247 3.53873-4.805978C3.658281-4.889664 3.837609-4.913574 4.088667-4.913574C4.303861-4.913574 4.519054-4.889664 4.686426-4.841843ZM6.144956-7.065504C6.144956-6.40797 5.822167-5.451557 5.045081-5.009215C4.817933-5.092902 4.507098-5.152677 4.244085-5.152677C3.993026-5.152677 3.275716-5.176588 3.275716-4.794022C3.275716-4.471233 3.93325-4.507098 4.136488-4.507098C4.447323-4.507098 4.722291-4.578829 5.009215-4.662516C5.391781-4.351681 5.559153-3.945205 5.559153-3.347447C5.559153-2.654047 5.36787-2.092154 5.140722-1.578082C4.746202-.6934 3.813699-.119552 2.988792-.119552C2.116065-.119552 1.661768-.812951 1.661768-1.625903C1.661768-1.733499 1.661768-1.888917 1.709589-2.068244L2.486675-5.212453C2.881196-6.77858 3.88543-8.18929 5.045081-8.18929C5.905853-8.18929 6.144956-7.591532 6.144956-7.065504Z'/>
</defs>
<g id='eq3-page1'>
<use x='0' y='0' xlink:href='#eq3-g2-12'/>
<use x='7.271271' y='-4.338437' xlink:href='#eq3-g0-0'/>
<use x='13.857778' y='-4.338437' xlink:href='#eq3-g1-104'/>
<use x='18.737687' y='-4.338437' xlink:href='#eq3-g1-69'/>
<use x='25.390595' y='-4.338437' xlink:href='#eq3-g1-120'/>
<use x='30.157494' y='-4.338437' xlink:href='#eq3-g1-112'/>
</g>
</svg>).</p><p>The dictionary <em>ppProperties</em> contains the information concerning the permanent contact contribution to the solid phase pressure. In SedFoam, the model of Johnson and Jackson (1987) is used:</p><p><svg class="m-math" style="width: 11.321em; height: 2.280em; vertical-align: -0.639em;" viewBox="0 -15.771954 108.68498 21.887114">
<title>
$ p_{ff} = Fr \frac{\left( \alpha - \alpha_{min}^{Friction} \right)^{\eta}}{\left(\alpha_{Max} - \alpha \right)^p} $
</title>
<defs>
<path id='eq4-g4-40' d='M2.654047 1.992528C2.717808 1.992528 2.81345 1.992528 2.81345 1.896887C2.81345 1.865006 2.805479 1.857036 2.701868 1.753425C1.609963 .72528 1.338979-.757161 1.338979-1.992528C1.338979-4.28792 2.287422-5.363885 2.693898-5.730511C2.805479-5.834122 2.81345-5.842092 2.81345-5.881943S2.781569-5.977584 2.701868-5.977584C2.574346-5.977584 2.175841-5.571108 2.11208-5.499377C1.044085-4.383562 .820922-2.948941 .820922-1.992528C.820922-.207223 1.570112 1.227397 2.654047 1.992528Z'/>
<path id='eq4-g4-41' d='M2.462765-1.992528C2.462765-2.749689 2.335243-3.658281 1.841096-4.598755C1.45056-5.332005 .72528-5.977584 .581818-5.977584C.502117-5.977584 .478207-5.921793 .478207-5.881943C.478207-5.850062 .478207-5.834122 .573848-5.738481C1.689664-4.678456 1.944707-3.219925 1.944707-1.992528C1.944707 .294894 .996264 1.378829 .589788 1.745455C.486177 1.849066 .478207 1.857036 .478207 1.896887S.502117 1.992528 .581818 1.992528C.70934 1.992528 1.107846 1.586052 1.171606 1.514321C2.239601 .398506 2.462765-1.036115 2.462765-1.992528Z'/>
<path id='eq4-g1-17' d='M3.592528-1.625903C3.622416-1.733499 3.634371-1.793275 3.634371-1.942715C3.634371-2.414944 3.293649-2.636115 2.809465-2.636115C2.271482-2.636115 1.912827-2.27746 1.75741-2.074222C1.721544-2.486675 1.356912-2.636115 1.075965-2.636115C.800996-2.636115 .657534-2.438854 .579826-2.307347C.436364-2.056289 .364633-1.745455 .364633-1.721544C.364633-1.655791 .418431-1.63188 .472229-1.63188C.56787-1.63188 .573848-1.673724 .603736-1.769365C.729265-2.265504 .872727-2.438854 1.058032-2.438854C1.273225-2.438854 1.273225-2.193773 1.273225-2.133998C1.273225-2.038356 1.21345-1.799253 1.171606-1.63188C1.129763-1.470486 1.069988-1.225405 1.0401-1.093898C.998257-.944458 .962391-.789041 .920548-.639601C.878705-.472229 .806974-.17335 .806974-.137484C.806974-.005978 .908593 .059776 1.016189 .059776S1.225405-.011955 1.273225-.101619C1.285181-.137484 1.338979-.3467 1.368867-.466252L1.500374-1.004234C1.542217-1.159651 1.566127-1.267248 1.601993-1.404732C1.655791-1.619925 1.882939-1.960648 2.110087-2.169863C2.361146-2.385056 2.612204-2.438854 2.785554-2.438854C3.162142-2.438854 3.162142-2.12802 3.162142-2.020423C3.162142-1.882939 3.132254-1.745455 3.126276-1.721544L2.444832 1.004234C2.432877 1.052055 2.426899 1.06401 2.426899 1.08792C2.426899 1.159651 2.480697 1.285181 2.642092 1.285181C2.863263 1.285181 2.917061 1.069988 2.934994 .992279L3.592528-1.625903Z'/>
<path id='eq4-g1-70' d='M2.175841-1.912827H2.863263C3.341469-1.912827 3.419178-1.835118 3.419178-1.637858C3.419178-1.554172 3.383313-1.380822 3.359402-1.297136C3.359402-1.291158 3.371357-1.21345 3.472976-1.21345C3.556663-1.21345 3.568618-1.243337 3.592528-1.344956L3.951183-2.767621C3.951183-2.773599 3.939228-2.851308 3.837609-2.851308C3.747945-2.851308 3.73599-2.809465 3.718057-2.731756C3.58655-2.259527 3.443088-2.15193 2.881196-2.15193H2.241594L2.606227-3.616438C2.654047-3.807721 2.660025-3.819676 2.911083-3.819676H3.891407C4.674471-3.819676 4.889664-3.670237 4.889664-3.120299C4.889664-2.988792 4.865753-2.779577 4.865753-2.761644C4.865753-2.660025 4.94944-2.660025 4.979328-2.660025C5.074969-2.660025 5.080946-2.707846 5.092902-2.815442L5.200498-3.873474C5.218431-4.05878 5.17061-4.05878 5.021171-4.05878H1.661768C1.548194-4.05878 1.458531-4.05878 1.458531-3.90934C1.458531-3.819676 1.548194-3.819676 1.655791-3.819676S1.912827-3.819676 2.038356-3.777833C2.038356-3.718057 2.038356-3.682192 2.014446-3.58655L1.23736-.496139C1.183562-.280946 1.171606-.239103 .723288-.239103C.591781-.239103 .579826-.239103 .555915-.221171C.526027-.19726 .502117-.119552 .502117-.083686C.508095-.059776 .514072 0 .609714 0C.735243 0 .878705-.017933 1.010212-.017933C1.153674-.017933 1.291158-.02391 1.43462-.02391C1.596015-.02391 1.769365-.017933 1.93076-.017933C2.074222-.017933 2.241594 0 2.385056 0C2.426899 0 2.528518 0 2.528518-.14944C2.528518-.239103 2.456787-.239103 2.307347-.239103C2.289415-.239103 2.139975-.239103 1.996513-.251059C1.811208-.263014 1.793275-.280946 1.793275-.3467C1.793275-.352677 1.793275-.382565 1.817186-.472229L2.175841-1.912827Z'/>
<path id='eq4-g1-77' d='M6.437858-3.598506C6.485679-3.795766 6.497634-3.843587 6.975841-3.843587C7.083437-3.843587 7.167123-3.843587 7.167123-3.993026C7.167123-4.08269 7.089415-4.08269 6.981818-4.08269H6.133001C5.959651-4.08269 5.941719-4.076712 5.846077-3.939228L3.478954-.549938L2.815442-3.921295C2.785554-4.08269 2.749689-4.08269 2.594271-4.08269H1.697634C1.578082-4.08269 1.494396-4.08269 1.494396-3.93325C1.494396-3.843587 1.58406-3.843587 1.691656-3.843587S1.948692-3.843587 2.074222-3.801743C2.074222-3.741968 2.074222-3.706102 2.050311-3.610461L1.309091-.663512C1.249315-.418431 1.141719-.257036 .657534-.239103C.573848-.233126 .532005-.17335 .532005-.083686C.537983-.059776 .54396 0 .633624 0C.777086 0 1.129763-.02391 1.273225-.02391L1.601993-.017933C1.709589-.017933 1.835118 0 1.936737 0C2.062267 0 2.068244-.125529 2.068244-.155417C2.050311-.239103 1.990535-.239103 1.918804-.239103C1.643836-.245081 1.524284-.32279 1.524284-.478207C1.524284-.514072 1.530262-.537983 1.548194-.603736L2.343213-3.789788H2.349191L3.060523-.167372C3.084433-.059776 3.102366 0 3.198007 0C3.287671 0 3.335492-.059776 3.377335-.125529L5.971606-3.843587L5.977584-3.837609L5.140722-.496139C5.086924-.280946 5.074969-.239103 4.62665-.239103C4.495143-.239103 4.483188-.239103 4.459278-.221171C4.42939-.19726 4.405479-.119552 4.405479-.083686C4.411457-.059776 4.417435 0 4.507098 0C4.62665 0 4.758157-.017933 4.877709-.017933C5.009215-.017933 5.1467-.02391 5.278207-.02391C5.278207-.02391 5.69066-.017933 5.69066-.017933C5.810212-.017933 5.953674 0 6.073225 0C6.109091 0 6.150934 0 6.174844-.041843C6.1868-.059776 6.21071-.131507 6.21071-.155417C6.192777-.239103 6.138979-.239103 6.001494-.239103C5.929763-.239103 5.8401-.245081 5.774346-.251059C5.66675-.263014 5.624907-.263014 5.624907-.328767C5.624907-.352677 5.630884-.376588 5.648817-.436364L6.437858-3.598506Z'/>
<path id='eq4-g1-97' d='M3.102366-1.918804C3.132254-2.056289 3.19203-2.283437 3.19203-2.32528C3.19203-2.456787 3.090411-2.52254 2.982814-2.52254C2.815442-2.52254 2.713823-2.367123 2.69589-2.27746C2.612204-2.414944 2.408966-2.636115 2.038356-2.636115C1.273225-2.636115 .448319-1.835118 .448319-.956413C.448319-.310834 .902615 .059776 1.41071 .059776C1.811208 .059776 2.15193-.215193 2.30137-.364633C2.414944 .011955 2.815442 .059776 2.946949 .059776C3.162142 .059776 3.317559-.059776 3.431133-.245081C3.580573-.484184 3.664259-.830884 3.664259-.860772C3.664259-.872727 3.658281-.944458 3.550685-.944458C3.461021-.944458 3.449066-.902615 3.425156-.806974C3.329514-.442341 3.203985-.137484 2.970859-.137484C2.767621-.137484 2.749689-.352677 2.749689-.442341C2.749689-.52005 2.809465-.759153 2.851308-.91457L3.102366-1.918804ZM2.32528-.783064C2.295392-.675467 2.295392-.663512 2.211706-.573848C1.882939-.203238 1.578082-.137484 1.428643-.137484C1.189539-.137484 .956413-.298879 .956413-.723288C.956413-.968369 1.081943-1.554172 1.273225-1.894894C1.452553-2.217684 1.75741-2.438854 2.044334-2.438854C2.492653-2.438854 2.606227-1.966625 2.606227-1.924782L2.588294-1.841096L2.32528-.783064Z'/>
<path id='eq4-g1-99' d='M2.773599-2.295392C2.69589-2.27746 2.492653-2.175841 2.492653-1.95467C2.492653-1.80523 2.606227-1.727522 2.731756-1.727522C2.875218-1.727522 3.078456-1.829141 3.078456-2.116065C3.078456-2.504608 2.624159-2.636115 2.241594-2.636115C1.315068-2.636115 .448319-1.835118 .448319-1.004234C.448319-.436364 .860772 .059776 1.63188 .059776C2.755666 .059776 3.186052-.537983 3.186052-.603736C3.186052-.657534 3.120299-.723288 3.072478-.723288C3.04259-.723288 3.036613-.71731 2.946949-.627646C2.624159-.257036 2.068244-.137484 1.643836-.137484C1.147696-.137484 .968369-.460274 .968369-.806974C.968369-.824907 .980324-1.518306 1.392777-2.026401C1.482441-2.12802 1.793275-2.438854 2.247572-2.438854C2.27746-2.438854 2.594271-2.438854 2.773599-2.295392Z'/>
<path id='eq4-g1-105' d='M2.080199-3.730012C2.080199-3.873474 1.972603-3.969116 1.835118-3.969116C1.673724-3.969116 1.500374-3.813699 1.500374-3.640349C1.500374-3.490909 1.60797-3.401245 1.739477-3.401245C1.93076-3.401245 2.080199-3.580573 2.080199-3.730012ZM1.721544-1.643836C1.745455-1.703611 1.799253-1.847073 1.823163-1.900872C1.841096-1.95467 1.865006-2.014446 1.865006-2.116065C1.865006-2.450809 1.566127-2.636115 1.267248-2.636115C.657534-2.636115 .364633-1.847073 .364633-1.715567C.364633-1.685679 .388543-1.63188 .472229-1.63188S.573848-1.667746 .591781-1.721544C.759153-2.30137 1.075965-2.438854 1.243337-2.438854C1.362889-2.438854 1.404732-2.361146 1.404732-2.223661C1.404732-2.10411 1.368867-2.014446 1.356912-1.972603L1.046077-1.207472C.974346-1.034122 .974346-1.022167 .896638-.818929C.818929-.639601 .789041-.561893 .789041-.460274C.789041-.155417 1.06401 .059776 1.392777 .059776C1.996513 .059776 2.295392-.729265 2.295392-.860772C2.295392-.872727 2.289415-.944458 2.181818-.944458C2.098132-.944458 2.092154-.91457 2.056289-.800996C1.960648-.496139 1.715567-.137484 1.41071-.137484C1.303113-.137484 1.249315-.209215 1.249315-.352677C1.249315-.472229 1.285181-.561893 1.362889-.747198L1.721544-1.643836Z'/>
<path id='eq4-g1-109' d='M2.827397-.514072C2.797509-.388543 2.743711-.179328 2.743711-.137484C2.743711-.005978 2.84533 .059776 2.952927 .059776S3.162142-.011955 3.209963-.101619C3.221918-.137484 3.275716-.3467 3.305604-.466252L3.437111-1.004234C3.478954-1.159651 3.502864-1.267248 3.53873-1.404732C3.592528-1.60797 3.801743-1.924782 4.022914-2.145953C4.142466-2.259527 4.399502-2.438854 4.722291-2.438854C5.104857-2.438854 5.104857-2.133998 5.104857-2.020423C5.104857-1.667746 4.847821-1.028144 4.740224-.759153C4.704359-.657534 4.662516-.561893 4.662516-.460274C4.662516-.155417 4.937484 .059776 5.266252 .059776C5.869988 .059776 6.168867-.729265 6.168867-.860772C6.168867-.872727 6.162889-.944458 6.055293-.944458C5.971606-.944458 5.965629-.91457 5.929763-.800996C5.822167-.454296 5.565131-.137484 5.290162-.137484C5.206476-.137484 5.12279-.17335 5.12279-.352677C5.12279-.472229 5.164633-.579826 5.218431-.705355C5.284184-.872727 5.577086-1.596015 5.577086-1.942715C5.577086-2.432877 5.206476-2.636115 4.752179-2.636115C4.423412-2.636115 4.028892-2.516563 3.640349-2.008468C3.604483-2.450809 3.251806-2.636115 2.815442-2.636115C2.516563-2.636115 2.133998-2.540473 1.751432-2.068244C1.721544-2.52254 1.303113-2.636115 1.075965-2.636115S.6934-2.49863 .585803-2.307347C.430386-2.056289 .364633-1.739477 .364633-1.721544C.364633-1.655791 .418431-1.63188 .472229-1.63188C.56787-1.63188 .573848-1.673724 .603736-1.769365C.723288-2.241594 .86675-2.438854 1.058032-2.438854C1.26127-2.438854 1.273225-2.229639 1.273225-2.133998S1.21345-1.799253 1.171606-1.63188C1.129763-1.470486 1.069988-1.225405 1.0401-1.093898C.998257-.944458 .962391-.789041 .920548-.639601C.878705-.472229 .806974-.17335 .806974-.137484C.806974-.005978 .908593 .059776 1.016189 .059776S1.225405-.011955 1.273225-.101619C1.285181-.137484 1.338979-.3467 1.368867-.466252L1.500374-1.004234C1.542217-1.159651 1.566127-1.267248 1.601993-1.404732C1.655791-1.60797 1.865006-1.924782 2.086177-2.145953C2.205729-2.259527 2.462765-2.438854 2.785554-2.438854C3.16812-2.438854 3.16812-2.133998 3.16812-2.020423C3.16812-1.876961 3.108344-1.637858 3.060523-1.446575L2.827397-.514072Z'/>
<path id='eq4-g1-110' d='M1.751432-2.068244C1.721544-2.52254 1.303113-2.636115 1.075965-2.636115S.6934-2.49863 .585803-2.307347C.436364-2.062267 .364633-1.745455 .364633-1.721544C.364633-1.655791 .418431-1.63188 .472229-1.63188C.56787-1.63188 .573848-1.673724 .603736-1.769365C.723288-2.247572 .86675-2.438854 1.058032-2.438854C1.273225-2.438854 1.273225-2.193773 1.273225-2.133998C1.273225-2.038356 1.21345-1.799253 1.171606-1.63188C1.129763-1.470486 1.069988-1.225405 1.0401-1.093898C.998257-.944458 .962391-.789041 .920548-.639601C.878705-.472229 .806974-.17335 .806974-.137484C.806974-.005978 .908593 .059776 1.016189 .059776S1.225405-.011955 1.273225-.101619C1.285181-.137484 1.338979-.3467 1.368867-.466252L1.500374-1.004234C1.542217-1.159651 1.566127-1.267248 1.601993-1.404732C1.655791-1.60797 1.865006-1.924782 2.086177-2.145953C2.205729-2.259527 2.462765-2.438854 2.785554-2.438854C3.16812-2.438854 3.16812-2.133998 3.16812-2.020423C3.16812-1.667746 2.911083-1.028144 2.803487-.759153C2.767621-.657534 2.725778-.561893 2.725778-.460274C2.725778-.155417 3.000747 .059776 3.329514 .059776C3.93325 .059776 4.23213-.729265 4.23213-.860772C4.23213-.872727 4.226152-.944458 4.118555-.944458C4.034869-.944458 4.028892-.91457 3.993026-.800996C3.897385-.484184 3.652304-.137484 3.347447-.137484C3.233873-.137484 3.186052-.227148 3.186052-.352677C3.186052-.472229 3.227895-.573848 3.281694-.699377C3.371357-.932503 3.640349-1.60797 3.640349-1.942715C3.640349-2.432877 3.269738-2.636115 2.815442-2.636115C2.516563-2.636115 2.133998-2.540473 1.751432-2.068244Z'/>
<path id='eq4-g1-111' d='M3.395268-1.572105C3.395268-2.175841 2.934994-2.636115 2.235616-2.636115C1.333001-2.636115 .454296-1.841096 .454296-1.004234C.454296-.364633 .956413 .059776 1.60797 .059776C2.540473 .059776 3.395268-.753176 3.395268-1.572105ZM1.619925-.137484C1.273225-.137484 .974346-.3467 .974346-.806974C.974346-1.010212 1.06401-1.554172 1.315068-1.912827C1.566127-2.27746 1.936737-2.438854 2.229639-2.438854C2.534496-2.438854 2.875218-2.265504 2.875218-1.769365C2.875218-1.619925 2.815442-1.022167 2.480697-.591781C2.30137-.352677 1.960648-.137484 1.619925-.137484Z'/>
<path id='eq4-g1-112' d='M.579826 .723288C.537983 .878705 .532005 .920548 .274969 .920548C.19726 .920548 .161395 .920548 .137484 .956413C.125529 .980324 .101619 1.058032 .101619 1.075965C.107597 1.093898 .113574 1.159651 .19726 1.159651C.364633 1.159651 .561893 1.135741 .735243 1.135741C.842839 1.135741 .956413 1.141719 1.06401 1.141719C1.165629 1.141719 1.285181 1.159651 1.3868 1.159651C1.422665 1.159651 1.464508 1.159651 1.488418 1.117808C1.500374 1.099875 1.524284 1.028144 1.524284 1.004234C1.506351 .920548 1.446575 .920548 1.344956 .920548C1.201494 .920548 1.046077 .920548 1.046077 .848817C1.046077 .818929 1.08792 .663512 1.111831 .573848L1.327024-.298879C1.470486-.083686 1.691656 .059776 1.984558 .059776C2.773599 .059776 3.580573-.765131 3.580573-1.619925C3.580573-2.241594 3.144209-2.636115 2.618182-2.636115C2.133998-2.636115 1.75741-2.247572 1.727522-2.211706C1.619925-2.564384 1.249315-2.636115 1.075965-2.636115C.800996-2.636115 .657534-2.438854 .579826-2.307347C.436364-2.056289 .364633-1.745455 .364633-1.721544C.364633-1.655791 .418431-1.63188 .472229-1.63188C.56787-1.63188 .573848-1.673724 .603736-1.769365C.729265-2.265504 .872727-2.438854 1.058032-2.438854C1.273225-2.438854 1.273225-2.193773 1.273225-2.133998C1.273225-2.032379 1.267248-2.014446 1.255293-1.960648L.579826 .723288ZM1.703611-1.799253C1.733499-1.900872 1.733499-1.912827 1.841096-2.032379C2.032379-2.247572 2.319303-2.438854 2.600249-2.438854C2.887173-2.438854 3.072478-2.217684 3.072478-1.853051C3.072478-1.649813 2.952927-.986301 2.719801-.621669C2.516563-.310834 2.235616-.137484 1.984558-.137484C1.536239-.137484 1.416687-.603736 1.416687-.651557C1.416687-.681445 1.428643-.71731 1.43462-.74122L1.703611-1.799253Z'/>
<path id='eq4-g1-114' d='M1.697634-1.787298C1.715567-1.817186 1.853051-2.086177 2.086177-2.271482C2.157908-2.319303 2.331258-2.438854 2.606227-2.438854C2.660025-2.438854 2.851308-2.438854 3.006725-2.349191C2.851308-2.295392 2.761644-2.157908 2.761644-2.026401C2.761644-1.835118 2.917061-1.793275 3.000747-1.793275C3.174097-1.793275 3.347447-1.936737 3.347447-2.169863C3.347447-2.486675 3.000747-2.636115 2.618182-2.636115C2.462765-2.636115 2.098132-2.624159 1.733499-2.199751C1.643836-2.516563 1.321046-2.636115 1.075965-2.636115C.818929-2.636115 .675467-2.462765 .585803-2.319303C.454296-2.098132 .364633-1.75741 .364633-1.721544C.364633-1.655791 .418431-1.63188 .472229-1.63188C.56787-1.63188 .573848-1.673724 .603736-1.769365C.71731-2.229639 .860772-2.438854 1.058032-2.438854C1.243337-2.438854 1.273225-2.265504 1.273225-2.139975C1.273225-2.038356 1.21345-1.799253 1.171606-1.63188C1.129763-1.470486 1.069988-1.225405 1.0401-1.093898C.998257-.944458 .962391-.789041 .920548-.639601C.878705-.472229 .806974-.17335 .806974-.137484C.806974-.005978 .908593 .059776 1.016189 .059776C1.135741 .059776 1.249315-.02391 1.285181-.143462C1.303113-.191283 1.524284-1.093898 1.560149-1.231382L1.697634-1.787298Z'/>
<path id='eq4-g1-116' d='M1.60797-2.337235H2.259527C2.379078-2.337235 2.462765-2.337235 2.462765-2.486675C2.462765-2.576339 2.385056-2.576339 2.27746-2.576339H1.667746L1.876961-3.401245C1.900872-3.490909 1.900872-3.526775 1.900872-3.532752C1.900872-3.676214 1.787298-3.73599 1.691656-3.73599C1.619925-3.73599 1.464508-3.694147 1.41071-3.502864L1.177584-2.576339H.532005C.406476-2.576339 .400498-2.570361 .376588-2.552428C.3467-2.528518 .32279-2.450809 .32279-2.420922C.340722-2.337235 .394521-2.337235 .514072-2.337235H1.117808L.765131-.926526C.729265-.789041 .681445-.585803 .681445-.514072C.681445-.167372 .992279 .059776 1.356912 .059776C2.044334 .059776 2.450809-.759153 2.450809-.860772C2.450809-.878705 2.438854-.944458 2.337235-.944458C2.259527-.944458 2.247572-.91457 2.217684-.842839C2.014446-.394521 1.673724-.137484 1.380822-.137484C1.159651-.137484 1.153674-.358655 1.153674-.436364C1.153674-.52005 1.153674-.532005 1.183562-.645579L1.60797-2.337235Z'/>
<path id='eq4-g1-120' d='M3.36538-2.349191C3.156164-2.289415 3.108344-2.116065 3.108344-2.026401C3.108344-1.835118 3.263761-1.793275 3.347447-1.793275C3.520797-1.793275 3.694147-1.936737 3.694147-2.169863C3.694147-2.492653 3.341469-2.636115 3.036613-2.636115C2.642092-2.636115 2.402989-2.331258 2.337235-2.217684C2.259527-2.367123 2.032379-2.636115 1.58406-2.636115C.896638-2.636115 .490162-1.924782 .490162-1.715567C.490162-1.685679 .514072-1.63188 .597758-1.63188S.699377-1.667746 .71731-1.721544C.86675-2.205729 1.273225-2.438854 1.566127-2.438854S1.948692-2.247572 1.948692-2.050311C1.948692-1.97858 1.948692-1.924782 1.900872-1.739477C1.763387-1.183562 1.63188-.639601 1.601993-.56787C1.512329-.340722 1.297136-.137484 1.046077-.137484C1.010212-.137484 .842839-.137484 .705355-.227148C.938481-.304857 .962391-.502117 .962391-.549938C.962391-.705355 .842839-.783064 .723288-.783064C.555915-.783064 .376588-.651557 .376588-.406476C.376588-.065753 .753176 .059776 1.034122 .059776C1.374844 .059776 1.619925-.17335 1.733499-.358655C1.853051-.107597 2.139975 .059776 2.480697 .059776C3.186052 .059776 3.580573-.663512 3.580573-.860772C3.580573-.872727 3.574595-.944458 3.466999-.944458C3.383313-.944458 3.371357-.902615 3.353425-.848817C3.180075-.328767 2.755666-.137484 2.504608-.137484C2.27746-.137484 2.116065-.268991 2.116065-.52005C2.116065-.633624 2.145953-.765131 2.199751-.974346L2.391034-1.751432C2.450809-1.984558 2.480697-2.092154 2.606227-2.235616C2.689913-2.32528 2.833375-2.438854 3.024658-2.438854C3.054545-2.438854 3.233873-2.438854 3.36538-2.349191Z'/>
<path id='eq4-g5-40' d='M3.88543 2.905106C3.88543 2.86924 3.88543 2.84533 3.682192 2.642092C2.486675 1.43462 1.817186-.537983 1.817186-2.976837C1.817186-5.296139 2.379078-7.292653 3.765878-8.703362C3.88543-8.810959 3.88543-8.834869 3.88543-8.870735C3.88543-8.942466 3.825654-8.966376 3.777833-8.966376C3.622416-8.966376 2.642092-8.105604 2.056289-6.933998C1.446575-5.726526 1.171606-4.447323 1.171606-2.976837C1.171606-1.912827 1.338979-.490162 1.960648 .789041C2.666002 2.223661 3.646326 3.000747 3.777833 3.000747C3.825654 3.000747 3.88543 2.976837 3.88543 2.905106Z'/>
<path id='eq4-g5-41' d='M3.371357-2.976837C3.371357-3.88543 3.251806-5.36787 2.582316-6.75467C1.876961-8.18929 .896638-8.966376 .765131-8.966376C.71731-8.966376 .657534-8.942466 .657534-8.870735C.657534-8.834869 .657534-8.810959 .860772-8.607721C2.056289-7.400249 2.725778-5.427646 2.725778-2.988792C2.725778-.669489 2.163885 1.327024 .777086 2.737733C.657534 2.84533 .657534 2.86924 .657534 2.905106C.657534 2.976837 .71731 3.000747 .765131 3.000747C.920548 3.000747 1.900872 2.139975 2.486675 .968369C3.096389-.251059 3.371357-1.542217 3.371357-2.976837Z'/>
<path id='eq4-g5-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq4-g2-11' d='M4.064757-1.115816C4.805978-1.928767 5.068991-2.964882 5.068991-3.028643C5.068991-3.100374 5.021171-3.132254 4.94944-3.132254C4.845828-3.132254 4.837858-3.100374 4.790037-2.933001C4.566874-2.12005 4.088667-1.498381 4.064757-1.498381C4.048817-1.498381 4.048817-1.697634 4.048817-1.825156C4.032877-3.227895 3.124284-3.514819 2.582316-3.514819C1.458531-3.514819 .350685-2.422914 .350685-1.299128C.350685-.510087 .900623 .079701 1.745455 .079701C2.303362 .079701 2.893151-.119552 3.52279-.589788C3.698132 .039851 4.160399 .079701 4.303861 .079701C4.758157 .079701 5.021171-.326775 5.021171-.478207C5.021171-.573848 4.925529-.573848 4.901619-.573848C4.813948-.573848 4.798007-.549938 4.774097-.494147C4.646575-.159402 4.375592-.143462 4.335741-.143462C4.224159-.143462 4.096638-.143462 4.064757-1.115816ZM3.466999-.852802C2.901121-.342715 2.231631-.143462 1.769365-.143462C1.354919-.143462 .996264-.382565 .996264-1.020174C.996264-1.299128 1.123786-2.12005 1.498381-2.654047C1.817186-3.100374 2.247572-3.291656 2.574346-3.291656C3.012702-3.291656 3.259776-2.980822 3.363387-2.494645C3.482939-1.952677 3.419178-1.315068 3.466999-.852802Z'/>
<path id='eq4-g2-102' d='M3.052553-3.172105H3.793773C3.953176-3.172105 4.048817-3.172105 4.048817-3.323537C4.048817-3.435118 3.945205-3.435118 3.809714-3.435118H3.100374C3.227895-4.152428 3.307597-4.606725 3.387298-4.96538C3.419178-5.100872 3.443088-5.188543 3.56264-5.284184C3.666252-5.371856 3.730012-5.387796 3.817684-5.387796C3.937235-5.387796 4.064757-5.363885 4.168369-5.300125C4.128518-5.284184 4.080697-5.260274 4.040847-5.236364C3.905355-5.164633 3.809714-5.021171 3.809714-4.861768C3.809714-4.678456 3.953176-4.566874 4.128518-4.566874C4.359651-4.566874 4.574844-4.766127 4.574844-5.045081C4.574844-5.419676 4.192279-5.610959 3.809714-5.610959C3.53873-5.610959 3.036613-5.483437 2.781569-4.750187C2.709838-4.566874 2.709838-4.550934 2.494645-3.435118H1.896887C1.737484-3.435118 1.641843-3.435118 1.641843-3.283686C1.641843-3.172105 1.745455-3.172105 1.880946-3.172105H2.446824L1.872976-.079701C1.721544 .72528 1.601993 1.40274 1.179577 1.40274C1.155666 1.40274 .988294 1.40274 .836862 1.307098C1.203487 1.219427 1.203487 .884682 1.203487 .876712C1.203487 .6934 1.060025 .581818 .884682 .581818C.669489 .581818 .438356 .765131 .438356 1.067995C.438356 1.40274 .781071 1.625903 1.179577 1.625903C1.665753 1.625903 2.000498 1.115816 2.10411 .916563C2.391034 .390535 2.574346-.605729 2.590286-.68543L3.052553-3.172105Z'/>
<path id='eq4-g0-0' d='M5.571108-1.809215C5.69863-1.809215 5.873973-1.809215 5.873973-1.992528S5.69863-2.175841 5.571108-2.175841H1.004234C.876712-2.175841 .70137-2.175841 .70137-1.992528S.876712-1.809215 1.004234-1.809215H5.571108Z'/>
<path id='eq4-g3-70' d='M3.550685-3.897385H4.698381C5.606974-3.897385 5.678705-3.694147 5.678705-3.347447C5.678705-3.19203 5.654795-3.024658 5.595019-2.761644C5.571108-2.713823 5.559153-2.654047 5.559153-2.630137C5.559153-2.546451 5.606974-2.49863 5.69066-2.49863C5.786301-2.49863 5.798257-2.546451 5.846077-2.737733L6.539477-5.523288C6.539477-5.571108 6.503611-5.642839 6.419925-5.642839C6.312329-5.642839 6.300374-5.595019 6.252553-5.391781C6.001494-4.495143 5.762391-4.244085 4.722291-4.244085H3.634371L4.411457-7.340473C4.519054-7.758904 4.542964-7.79477 5.033126-7.79477H6.635118C8.129514-7.79477 8.344707-7.352428 8.344707-6.503611C8.344707-6.43188 8.344707-6.168867 8.308842-5.858032C8.296887-5.810212 8.272976-5.654795 8.272976-5.606974C8.272976-5.511333 8.332752-5.475467 8.404483-5.475467C8.488169-5.475467 8.53599-5.523288 8.5599-5.738481L8.810959-7.830635C8.810959-7.866501 8.834869-7.986052 8.834869-8.009963C8.834869-8.141469 8.727273-8.141469 8.51208-8.141469H2.84533C2.618182-8.141469 2.49863-8.141469 2.49863-7.926276C2.49863-7.79477 2.582316-7.79477 2.785554-7.79477C3.526775-7.79477 3.526775-7.711083 3.526775-7.579577C3.526775-7.519801 3.514819-7.47198 3.478954-7.340473L1.865006-.884682C1.75741-.466252 1.733499-.3467 .896638-.3467C.669489-.3467 .549938-.3467 .549938-.131507C.549938 0 .657534 0 .729265 0C.956413 0 1.195517-.02391 1.422665-.02391H2.976837C3.239851-.02391 3.526775 0 3.789788 0C3.897385 0 4.040847 0 4.040847-.215193C4.040847-.3467 3.969116-.3467 3.706102-.3467C2.761644-.3467 2.737733-.430386 2.737733-.609714C2.737733-.669489 2.761644-.765131 2.785554-.848817L3.550685-3.897385Z'/>
<path id='eq4-g3-112' d='M.514072 1.518306C.430386 1.876961 .382565 1.972603-.107597 1.972603C-.251059 1.972603-.37061 1.972603-.37061 2.199751C-.37061 2.223661-.358655 2.319303-.227148 2.319303C-.071731 2.319303 .095641 2.295392 .251059 2.295392H.765131C1.016189 2.295392 1.625903 2.319303 1.876961 2.319303C1.948692 2.319303 2.092154 2.319303 2.092154 2.10411C2.092154 1.972603 2.008468 1.972603 1.80523 1.972603C1.255293 1.972603 1.219427 1.888917 1.219427 1.793275C1.219427 1.649813 1.75741-.406476 1.829141-.681445C1.960648-.3467 2.283437 .119552 2.905106 .119552C4.25604 .119552 5.71457-1.637858 5.71457-3.395268C5.71457-4.495143 5.092902-5.272229 4.196264-5.272229C3.431133-5.272229 2.785554-4.531009 2.654047-4.363636C2.558406-4.961395 2.092154-5.272229 1.613948-5.272229C1.267248-5.272229 .992279-5.104857 .765131-4.65056C.549938-4.220174 .382565-3.490909 .382565-3.443088S.430386-3.335492 .514072-3.335492C.609714-3.335492 .621669-3.347447 .6934-3.622416C.872727-4.327771 1.099875-5.033126 1.578082-5.033126C1.853051-5.033126 1.948692-4.841843 1.948692-4.483188C1.948692-4.196264 1.912827-4.076712 1.865006-3.861519L.514072 1.518306ZM2.582316-3.730012C2.666002-4.064757 3.000747-4.411457 3.19203-4.578829C3.323537-4.698381 3.718057-5.033126 4.172354-5.033126C4.698381-5.033126 4.937484-4.507098 4.937484-3.88543C4.937484-3.311582 4.60274-1.960648 4.303861-1.338979C4.004981-.6934 3.455044-.119552 2.905106-.119552C2.092154-.119552 1.960648-1.147696 1.960648-1.195517C1.960648-1.231382 1.984558-1.327024 1.996513-1.3868L2.582316-3.730012Z'/>
<path id='eq4-g3-114' d='M4.65056-4.889664C4.27995-4.817933 4.088667-4.554919 4.088667-4.291905C4.088667-4.004981 4.315816-3.90934 4.483188-3.90934C4.817933-3.90934 5.092902-4.196264 5.092902-4.554919C5.092902-4.937484 4.722291-5.272229 4.124533-5.272229C3.646326-5.272229 3.096389-5.057036 2.594271-4.327771C2.510585-4.961395 2.032379-5.272229 1.554172-5.272229C1.08792-5.272229 .848817-4.913574 .705355-4.65056C.502117-4.220174 .32279-3.502864 .32279-3.443088C.32279-3.395268 .37061-3.335492 .454296-3.335492C.549938-3.335492 .561893-3.347447 .633624-3.622416C.812951-4.339726 1.0401-5.033126 1.518306-5.033126C1.80523-5.033126 1.888917-4.829888 1.888917-4.483188C1.888917-4.220174 1.769365-3.753923 1.685679-3.383313L1.350934-2.092154C1.303113-1.865006 1.171606-1.327024 1.111831-1.111831C1.028144-.800996 .896638-.239103 .896638-.179328C.896638-.011955 1.028144 .119552 1.207472 .119552C1.338979 .119552 1.566127 .035866 1.637858-.203238C1.673724-.298879 2.116065-2.10411 2.187796-2.379078C2.247572-2.642092 2.319303-2.893151 2.379078-3.156164C2.426899-3.323537 2.47472-3.514819 2.510585-3.670237C2.546451-3.777833 2.86924-4.363636 3.16812-4.62665C3.311582-4.758157 3.622416-5.033126 4.112578-5.033126C4.303861-5.033126 4.495143-4.99726 4.65056-4.889664Z'/>
</defs>
<g id='eq4-page1'>
<use x='0' y='0' xlink:href='#eq4-g3-112'/>
<use x='5.875143' y='1.793263' xlink:href='#eq4-g2-102'/>
<use x='10.821909' y='1.793263' xlink:href='#eq4-g2-102'/>
<use x='19.587637' y='0' xlink:href='#eq4-g5-61'/>
<use x='32.013118' y='0' xlink:href='#eq4-g3-70'/>
<use x='41.216733' y='0' xlink:href='#eq4-g3-114'/>
<use x='48.01272' y='-6.694865' xlink:href='#eq4-g5-40'/>
<use x='52.565046' y='-7.691129' xlink:href='#eq4-g2-11'/>
<use x='58.003985' y='-7.691129' xlink:href='#eq4-g0-0'/>
<use x='64.590492' y='-7.691129' xlink:href='#eq4-g2-11'/>
<use x='70.029431' y='-10.503915' xlink:href='#eq4-g1-70'/>
<use x='75.630621' y='-10.503915' xlink:href='#eq4-g1-114'/>
<use x='79.290483' y='-10.503915' xlink:href='#eq4-g1-105'/>
<use x='81.954109' y='-10.503915' xlink:href='#eq4-g1-99'/>
<use x='85.296433' y='-10.503915' xlink:href='#eq4-g1-116'/>
<use x='88.146842' y='-10.503915' xlink:href='#eq4-g1-105'/>
<use x='90.810467' y='-10.503915' xlink:href='#eq4-g1-111'/>
<use x='94.471739' y='-10.503915' xlink:href='#eq4-g1-110'/>
<use x='70.029431' y='-5.108954' xlink:href='#eq4-g1-109'/>
<use x='76.567385' y='-5.108954' xlink:href='#eq4-g1-105'/>
<use x='79.231011' y='-5.108954' xlink:href='#eq4-g1-110'/>
<use x='99.570614' y='-6.694865' xlink:href='#eq4-g5-41'/>
<use x='104.12294' y='-13.198279' xlink:href='#eq4-g1-17'/>
<rect x='48.01272' y='-3.227886' height='.478187' width='60.672259'/>
<use x='56.007961' y='4.122632' xlink:href='#eq4-g4-40'/>
<use x='59.301214' y='4.122632' xlink:href='#eq4-g2-11'/>
<use x='64.740154' y='5.462061' xlink:href='#eq4-g1-77'/>
<use x='72.328336' y='5.462061' xlink:href='#eq4-g1-97'/>
<use x='76.362511' y='5.462061' xlink:href='#eq4-g1-120'/>
<use x='81.032481' y='4.122632' xlink:href='#eq4-g0-0'/>
<use x='87.618988' y='4.122632' xlink:href='#eq4-g2-11'/>
<use x='93.057927' y='4.122632' xlink:href='#eq4-g4-41'/>
<use x='96.351181' y='.60801' xlink:href='#eq4-g1-112'/>
</g>
</svg></p><pre>ppModel          JohnsonJackson;

alphaMax         alphaMax [ 0 0 0 0 0 0 0 ] 0.635;

alphaMinFriction alphaMinFriction [ 0 0 0 0 0 0 0 ] 0.57;

Fr               Fr [ 1 -1 -2 0 0 0 0 ] 5e-2;

eta0             eta0 [ 0 0 0 0 0 0 0 ] 3;

eta1             eta1 [ 0 0 0 0 0 0 0 ] 5;

packingLimiter  no;</pre><p>And the dictionary <em>granularRheologyProperties</em> controls the granular rheology part:</p><pre>granularRheology   on;

granularDilatancy  off;

granularCohesion off;

alphaMaxG       alphaMaxG [ 0 0 0 0 0 0 0 ] 0.6;

mus             mus  [ 0 0 0 0 0 0 0 ] 0.24;

mu2             mu2  [ 0 0 0 0 0 0 0 ] 0.39;

I0              I0  [ 0 0 0 0 0 0 0 ] 0.01;

Bphi            Bphi [ 0 0 0 0 0 0 0 ] 1.;

n               n [ 0 0 0 0 0 0 0 ] 1.;

Dsmall          Dsmall [ 0 0 -1 0 0 0 0 ] 1e-4;

relaxPa         relaxPa [ 0 0 0 0 0 0 0 ] 1;

FrictionModel   Coulomb;

PPressureModel  none;

FluidViscosityModel Einstein;</pre><p>On the first line the switch granularRheology allows to turn on and off this module. The keywords FrictionModel, PPressureModel and FluidViscosityModel allow to choose the friction model, the shear induced particle pressure model and the effective viscosity model (see <a href="inputs.html" class="m-doc">Input Parameters</a> for details).</p><p>For the present case the granularRheology is set to Coulomb and the FluidViscosityModel is used for the effective viscosity model and an Einstein model is used. All the details concerning the different models can be found in the Geophysical Model Development paper on SedFoam.</p><p>The remaining dictionaries are not used for this tutorial and will not be detailed here. Their content will be explained in the next tutorials when they are used.</p></section><section id="control_sedFoam"><h5><a href="#control_sedFoam">Control</a></h5><p>Input data related to the control of time and reading and writing of the solution data are read from the controlDict dictionary. The user should view this file as a case control file, it is located in the <em>system</em> directory.</p><p>The start/stop times and the time step for the run must be set. In this tutorial we wish to start the run at time t = 0 which means that OpenFOAM needs to read field data from a directory named 0. Therefore we set the startFrom keyword to startTime and then specify the startTime keyword to be 0.</p><p>As the simulation progresses we wish to write results at certain intervals of time that we can later view with a post-processing package. The writeControl keyword presents several options for setting the time at which the results are written; here we select the adjustableRunTime option which specifies that results are written every writeInterval seconds of simulated time, adjusting the time steps to coincide with the writeInterval if necessary and the time step is automatically adjusted using adjustTimeStep = on. The time step controlled using different criteria on Courant numbers based on the maximum velocity, the relative velocity ( <svg class="m-math" style="width: 7.019em; height: 1.038em; vertical-align: -0.187em;" viewBox="0 -8.169366 67.382353 9.962629">
<title>
$ U_r=U_b-U_a $
</title>
<defs>
<path id='eq5-g0-0' d='M7.878456-2.749689C8.081694-2.749689 8.296887-2.749689 8.296887-2.988792S8.081694-3.227895 7.878456-3.227895H1.41071C1.207472-3.227895 .992279-3.227895 .992279-2.988792S1.207472-2.749689 1.41071-2.749689H7.878456Z'/>
<path id='eq5-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq5-g1-97' d='M3.124284-3.036613C3.052553-3.172105 2.82142-3.514819 2.335243-3.514819C1.3868-3.514819 .342715-2.406974 .342715-1.227397C.342715-.398506 .876712 .079701 1.490411 .079701C2.000498 .079701 2.438854-.326775 2.582316-.486177C2.725778 .063761 3.267746 .079701 3.363387 .079701C3.730012 .079701 3.913325-.223163 3.977086-.358655C4.136488-.645579 4.24807-1.107846 4.24807-1.139726C4.24807-1.187547 4.216189-1.243337 4.120548-1.243337S4.008966-1.195517 3.961146-.996264C3.849564-.557908 3.698132-.143462 3.387298-.143462C3.203985-.143462 3.132254-.294894 3.132254-.518057C3.132254-.653549 3.203985-.924533 3.251806-1.123786S3.419178-1.801245 3.451059-1.944707L3.610461-2.550436C3.650311-2.741719 3.737983-3.076463 3.737983-3.116314C3.737983-3.299626 3.58655-3.363387 3.482939-3.363387C3.363387-3.363387 3.164134-3.283686 3.124284-3.036613ZM2.582316-.860772C2.183811-.310834 1.769365-.143462 1.514321-.143462C1.147696-.143462 .964384-.478207 .964384-.892653C.964384-1.267248 1.179577-2.12005 1.354919-2.470735C1.586052-2.956912 1.976588-3.291656 2.343213-3.291656C2.86127-3.291656 3.012702-2.709838 3.012702-2.614197C3.012702-2.582316 2.81345-1.801245 2.765629-1.594022C2.662017-1.219427 2.662017-1.203487 2.582316-.860772Z'/>
<path id='eq5-g1-98' d='M1.944707-5.292154C1.952677-5.308095 1.976588-5.411706 1.976588-5.419676C1.976588-5.459527 1.944707-5.531258 1.849066-5.531258C1.817186-5.531258 1.570112-5.507347 1.3868-5.491407L.940473-5.459527C.765131-5.443587 .68543-5.435616 .68543-5.292154C.68543-5.180573 .797011-5.180573 .892653-5.180573C1.275218-5.180573 1.275218-5.132752 1.275218-5.061021C1.275218-5.0132 1.195517-4.694396 1.147696-4.511083L.454296-1.737484C.390535-1.466501 .390535-1.346949 .390535-1.211457C.390535-.390535 .892653 .079701 1.506351 .079701C2.486675 .079701 3.506849-1.052055 3.506849-2.207721C3.506849-2.996762 2.996762-3.514819 2.359153-3.514819C1.912827-3.514819 1.570112-3.227895 1.39477-3.076463L1.944707-5.292154ZM1.506351-.143462C1.219427-.143462 .932503-.366625 .932503-.948443C.932503-1.163636 .964384-1.362889 1.060025-1.745455C1.115816-1.976588 1.171606-2.199751 1.235367-2.430884C1.275218-2.574346 1.275218-2.590286 1.370859-2.709838C1.641843-3.044583 2.000498-3.291656 2.335243-3.291656C2.733748-3.291656 2.885181-2.901121 2.885181-2.542466C2.885181-2.247572 2.709838-1.39477 2.470735-.924533C2.263512-.494147 1.880946-.143462 1.506351-.143462Z'/>
<path id='eq5-g1-114' d='M1.538232-1.099875C1.625903-1.44259 1.713574-1.785305 1.793275-2.13599C1.801245-2.15193 1.857036-2.383064 1.865006-2.422914C1.888917-2.494645 2.088169-2.82142 2.295392-3.020672C2.550436-3.251806 2.82142-3.291656 2.964882-3.291656C3.052553-3.291656 3.196015-3.283686 3.307597-3.188045C2.964882-3.116314 2.917061-2.82142 2.917061-2.749689C2.917061-2.574346 3.052553-2.454795 3.227895-2.454795C3.443088-2.454795 3.682192-2.630137 3.682192-2.948941C3.682192-3.235866 3.435118-3.514819 2.980822-3.514819C2.438854-3.514819 2.072229-3.156164 1.904857-2.940971C1.745455-3.514819 1.203487-3.514819 1.123786-3.514819C.836862-3.514819 .637609-3.331507 .510087-3.084433C.326775-2.725778 .239103-2.319303 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.223661 .526027-2.430884C.621669-2.82142 .765131-3.291656 1.099875-3.291656C1.307098-3.291656 1.354919-3.092403 1.354919-2.917061C1.354919-2.773599 1.315068-2.622167 1.251308-2.359153C1.235367-2.295392 1.115816-1.825156 1.083935-1.713574L.789041-.518057C.757161-.398506 .70934-.199253 .70934-.167372C.70934 .01594 .860772 .079701 .964384 .079701C1.243337 .079701 1.299128-.143462 1.362889-.414446L1.538232-1.099875Z'/>
<path id='eq5-g2-85' d='M6.049315-2.749689C5.630884-1.075965 4.244085-.095641 3.120299-.095641C2.259527-.095641 1.673724-.669489 1.673724-1.661768C1.673724-1.709589 1.673724-2.068244 1.80523-2.594271L2.976837-7.292653C3.084433-7.699128 3.108344-7.81868 3.957161-7.81868C4.172354-7.81868 4.291905-7.81868 4.291905-8.033873C4.291905-8.16538 4.184309-8.16538 4.112578-8.16538C3.897385-8.16538 3.646326-8.141469 3.419178-8.141469H2.008468C1.78132-8.141469 1.530262-8.16538 1.303113-8.16538C1.219427-8.16538 1.075965-8.16538 1.075965-7.938232C1.075965-7.81868 1.159651-7.81868 1.3868-7.81868C2.10411-7.81868 2.10411-7.723039 2.10411-7.591532C2.10411-7.519801 2.020423-7.173101 1.960648-6.969863L.920548-2.785554C.884682-2.654047 .812951-2.331258 .812951-2.008468C.812951-.6934 1.75741 .251059 3.060523 .251059C4.267995 .251059 5.606974-.705355 6.216687-2.223661C6.300374-2.426899 6.40797-2.84533 6.479701-3.16812C6.599253-3.598506 6.850311-4.65056 6.933998-4.961395L7.388294-6.75467C7.543711-7.376339 7.639352-7.770859 8.691407-7.81868C8.787049-7.830635 8.834869-7.926276 8.834869-8.033873C8.834869-8.16538 8.727273-8.16538 8.679452-8.16538C8.51208-8.16538 8.296887-8.141469 8.129514-8.141469H7.567621C6.826401-8.141469 6.443836-8.16538 6.43188-8.16538C6.360149-8.16538 6.216687-8.16538 6.216687-7.938232C6.216687-7.81868 6.312329-7.81868 6.396015-7.81868C7.113325-7.79477 7.161146-7.519801 7.161146-7.304608C7.161146-7.197011 7.161146-7.161146 7.113325-6.993773L6.049315-2.749689Z'/>
</defs>
<g id='eq5-page1'>
<use x='0' y='0' xlink:href='#eq5-g2-85'/>
<use x='7.950255' y='1.793263' xlink:href='#eq5-g1-114'/>
<use x='15.825812' y='0' xlink:href='#eq5-g3-61'/>
<use x='28.251293' y='0' xlink:href='#eq5-g2-85'/>
<use x='36.201547' y='1.793263' xlink:href='#eq5-g1-98'/>
<use x='42.978928' y='0' xlink:href='#eq5-g0-0'/>
<use x='54.934088' y='0' xlink:href='#eq5-g2-85'/>
<use x='62.884343' y='1.793263' xlink:href='#eq5-g1-97'/>
</g>
</svg>) and the interfacial Courant number. The maximum values of the Courant numbers (maxCo and maxAlphaCo) are set in the controlDict and the maximum value of the time step is controlled by the parameter maxDeltaT.</p><p>OpenFOAM creates a new directory named after the current time, e.g. 20 s, on each occasion that it writes a set of data. For this case, the entries in the controlDict are shown below:</p><pre>application     sedFoam;

startFrom       latestTime;

startTime       0;

stopAt          endTime;

endTime         1800;

deltaT          1e-5;

writeControl    adjustableRunTime;

writeInterval   20;

purgeWrite      0;

writeFormat     ascii;

writePrecision  6;

timeFormat      general;

timePrecision   6;

runTimeModifiable on;

adjustTimeStep  on;

maxCo           0.3;

maxAlphaCo      0.3;

maxDeltaT       2e-1;</pre></section><section id="Disc_solv"><h5><a href="#Disc_solv">Discretisation and linear-solver settings</a></h5><p>The numerical schemes and linear solvers are set in the <em>system/fvSchemes</em> and <em>system/fvSolution</em> files respectively.</p><p>Concerning the numerical schemes, the time discretisation is an Euler implicit scheme, the divergence terms are of Gauss limitedLinear type (2nd order centered schemes with a Sweby limiter) and the laplacian scheme is Gauss linear corrected for all terms. The <em>fvScheme</em> file is shown below:</p><pre>ddtSchemes
{
    default         Euler implicit;
}

gradSchemes
{
        default         Gauss linear;
}

divSchemes
{
    default         none;
// alphaEqn
    div(phi,alpha)  Gauss upwind;//limitedLinear01 1;
    div(phir,alpha) Gauss upwind;//limitedLinear01 1;
// UEqn
    div(phi.a,U.a)    Gauss limitedLinearV 1;
    div(phi.b,U.b)    Gauss limitedLinearV 1;
    div(phiRa,Ua)   Gauss limitedLinear 1;
    div(phiRb,Ub)   Gauss limitedLinear 1;
// pEqn
    div(alpha,nu)   Gauss linear;
// alphaPlastic
    div(phia,alphaPlastic)   Gauss limitedLinear01 1;
// pa
    div(phia,pa_new_value)   Gauss limitedLinear 1;
}

laplacianSchemes
{
    default         none;
// UEqn
    laplacian(nuEffa,U.a) Gauss linear corrected;
    laplacian(nuEffb,U.b) Gauss linear corrected;
    laplacian(nuFra,U.a)  Gauss linear corrected;
// pEqn
    laplacian((rho*(1|A(U))),p_rbgh) Gauss linear corrected;
}

interpolationSchemes
{
    default  linear;
}

snGradSchemes
{
    default         corrected;
}

fluxRequired
{
    default         no;
    p_rbgh               ;
}</pre><p>In the <em>system/fvSolution</em> file, the user can specify the linear solver he/she wants to use for each equation and the tolerance for the resolution. The user can also control the number of corrector steps and non-orthogonal correctors (useless for cartesian grids) for the PIMPLE algorithm. In the present case, a single PIMPLE corrector is enough the residual of the pressure equation is shown to converge well. The <em>fvSolution</em> file is reproduced below:</p><pre>solvers
{
    p_rbgh
    {
        solver          GAMG;
        tolerance       1e-9;
        relTol          0.0001;
        smoother        DIC;
        nPreSweeps      0;
        nPostSweeps     2;
        nFinestSweeps   2;
        cacheAgglomeration true;
        nCellsInCoarsestLevel 10;
        agglomerator    faceAreaPair;
        mergeLevels     1;
    }

    p_rbghFinal
    {
        $p_rbgh;
        tolerance       1e-9;
        relTol          0;
    }
    &quot;(alpha.a|U.a|U.b|pa_new_value|alphaPlastic)&quot;
    {
        solver          PBiCG;
        preconditioner  DILU;
        tolerance       1e-9;
        relTol          0;
    }
    &quot;(alpha.aFinal|U.aFinal|U.bFinal|paFinal|alphaPlasticFinal)&quot;
    {
        solver          PBiCG;
        preconditioner  DILU;
        tolerance       1e-9;
        relTol          0;
    }
}

PIMPLE
{
    momentumPredictor 0;
    nOuterCorrectors  1;
    nCorrectors     1;
    nNonOrthogonalCorrectors 0;
    correctAlpha    0;
    nAlphaCorr      1;
    pRefCell        0;
    pRefValue       0;
}


relaxationFactors
{
    fields
    {
        p_rbgh               1.;
        p_rbghFinal          1;
    }
    equations
    {
        &quot;U.a|U.b&quot;             1.;
        &quot;(U.a|U.b)Final&quot;      1;
    }

}
</pre></section></section></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages, OpenGL, GLSL, Vulkan and OpenAL APIs. You can omit any prefix from the symbol or file path; adding a <code>:</code> or <code>/</code> suffix lists all members of given symbol or directory.</p> <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span> / <span class="m-label m-dim">&uarr;</span> to navigate through the list, <span class="m-label m-dim">Enter</span> to go. <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can copy a link to the result using <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>sedExnerFoam docs. Part of the <a href="https://github.com/SedFoam/sedExnerFoam">sedExnerFoam project</a>, copyright © <a href="cyrille.bonamy@univ-grenoble-alpes.fr/">Cyrille Bonamy</a> and <a href="credits-contributors.html">contributors</a>, 2015&ndash;2021.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.9.3 and <a href="https://mcss.mosra.cz/">m.css</a>. Contact the team via <a href="https://github.com/SedFoam/sedExnerFoam">GitHub</a>, <a href="mailto:cyrille.bonamy@univ-grenoble-alpes.fr">e-mail</a> or <a href="https://twitter.com/sedfoam">Twitter</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
